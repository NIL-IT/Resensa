{"version":3,"file":"LoginForm-BrfzFPjp.js","sources":["../../../src/components/pages/LoginForm.jsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { authPost, changeIsAdmin } from \"../../utils/slice/userSlice\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nexport default function LoginForm() {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const { error } = useSelector((state) => state.user);\r\n  const [form, setForm] = React.useState({\r\n    username: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    dispatch(changeIsAdmin(false));\r\n    // Check for existing token\r\n    const token = Cookies.get(\"access_token\");\r\n    if (token) {\r\n      dispatch(changeIsAdmin(true));\r\n      navigate(\"/admin/1\");\r\n    }\r\n  }, [dispatch, navigate]);\r\n\r\n  const handleChange = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      const resultAction = await dispatch(authPost(form));\r\n      if (authPost.fulfilled.match(resultAction)) {\r\n        const token = resultAction.payload;\r\n        // Store token in cookies for 1 day\r\n        Cookies.set(\"access_token\", token, { expires: 1 });\r\n        dispatch(changeIsAdmin(true));\r\n        navigate(\"/admin/1\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Login failed:\", err);\r\n    }\r\n    setForm({\r\n      username: \"\",\r\n      password: \"\",\r\n    });\r\n  };\r\n\r\n  return (\r\n    <article className=\"w-screen h-screen\">\r\n      <div className=\"flex min-h-full flex-col justify-center px-6 py-12 lg:px-8\">\r\n        <div className=\"sm:mx-auto sm:w-full sm:max-w-sm\">\r\n          <Link to={\"/\"}>\r\n            <img\r\n              className=\"mx-auto h-10 w-auto\"\r\n              src=\"/icon/logo.svg\"\r\n              alt=\"Recensa\"\r\n              title=\"Recensa\"\r\n            />\r\n          </Link>\r\n          <h2 className=\"mt-10 text-center text-2xl/9 font-bold tracking-tight text-gray-900\">\r\n            Войти в аккаунт\r\n          </h2>\r\n        </div>\r\n\r\n        <div className=\"mt-10 sm:mx-auto sm:w-full sm:max-w-sm\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            <div>\r\n              <label\r\n                htmlFor=\"username\"\r\n                className=\"block text-sm/6 font-medium text-gray-900\"\r\n              >\r\n                Имя пользователя\r\n              </label>\r\n              <div className=\"mt-2\">\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"username\"\r\n                  id=\"username\"\r\n                  value={form.username}\r\n                  onChange={handleChange}\r\n                  required\r\n                  className=\"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <label\r\n                  htmlFor=\"password\"\r\n                  className=\"block text-sm/6 font-medium text-gray-900\"\r\n                >\r\n                  Пароль\r\n                </label>\r\n              </div>\r\n              <div className=\"mt-2\">\r\n                <input\r\n                  type=\"password\"\r\n                  name=\"password\"\r\n                  id=\"password\"\r\n                  value={form.password}\r\n                  onChange={handleChange}\r\n                  required\r\n                  className=\"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-gray-400 sm:text-sm/6\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"text-red-500 text-sm text-center\">{error}</div>\r\n            )}\r\n\r\n            <div>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"flex w-full justify-center rounded-md bg-gray-400 px-3 py-1.5 text-sm/6 font-semibold text-white shadow-sm hover:bg-gray-300 transition-colors\"\r\n              >\r\n                Войти\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </article>\r\n  );\r\n}\r\n"],"names":["LoginForm","dispatch","useDispatch","navigate","useNavigate","error","useSelector","state","form","setForm","React","useEffect","changeIsAdmin","Cookies","handleChange","e","__spreadProps","__spreadValues","handleSubmit","__async","resultAction","authPost","token","err","jsxs","jsx","Link"],"mappings":"6yBAMA,SAAwBA,GAAY,CAClC,MAAMC,EAAWC,EAAY,EACvBC,EAAWC,EAAY,EACvB,CAAE,MAAAC,CAAM,EAAIC,EAAaC,GAAUA,EAAM,IAAI,EAC7C,CAACC,EAAMC,CAAO,EAAIC,EAAM,SAAS,CACrC,SAAU,GACV,SAAU,EAAA,CACX,EAEDC,EAAAA,UAAU,IAAM,CACLV,EAAAW,EAAc,EAAK,CAAC,EAEfC,EAAQ,IAAI,cAAc,IAE7BZ,EAAAW,EAAc,EAAI,CAAC,EAC5BT,EAAS,UAAU,EACrB,EACC,CAACF,EAAUE,CAAQ,CAAC,EAEjB,MAAAW,EAAgBC,GAAM,CAClBN,EAAAO,EAAAC,EAAA,GAAKT,GAAL,CAAW,CAACO,EAAE,OAAO,IAAI,EAAGA,EAAE,OAAO,OAAO,CACtD,EAEMG,EAAsBH,GAAMI,EAAA,sBAChCJ,EAAE,eAAe,EAEb,GAAA,CACF,MAAMK,EAAe,MAAMnB,EAASoB,EAASb,CAAI,CAAC,EAClD,GAAIa,EAAS,UAAU,MAAMD,CAAY,EAAG,CAC1C,MAAME,EAAQF,EAAa,QAE3BP,EAAQ,IAAI,eAAgBS,EAAO,CAAE,QAAS,EAAG,EACxCrB,EAAAW,EAAc,EAAI,CAAC,EAC5BT,EAAS,UAAU,CAAA,QAEdoB,EAAK,CACJ,QAAA,MAAM,gBAAiBA,CAAG,CAAA,CAE5Bd,EAAA,CACN,SAAU,GACV,SAAU,EAAA,CACX,CACH,GAEA,aACG,UAAQ,CAAA,UAAU,oBACjB,SAACe,EAAA,KAAA,MAAA,CAAI,UAAU,6DACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,mCACb,SAAA,CAACC,EAAAA,IAAAC,EAAA,CAAK,GAAI,IACR,SAAAD,EAAA,IAAC,MAAA,CACC,UAAU,sBACV,IAAI,iBACJ,IAAI,UACJ,MAAM,SAAA,CAAA,EAEV,EACCA,EAAA,IAAA,KAAA,CAAG,UAAU,sEAAsE,SAEpF,iBAAA,CAAA,CAAA,EACF,EAEAA,EAAAA,IAAC,OAAI,UAAU,yCACb,gBAAC,OAAK,CAAA,SAAUP,EAAc,UAAU,YACtC,SAAA,CAAAM,OAAC,MACC,CAAA,SAAA,CAAAC,EAAA,IAAC,QAAA,CACC,QAAQ,WACR,UAAU,4CACX,SAAA,kBAAA,CAED,EACAA,EAAAA,IAAC,MAAI,CAAA,UAAU,OACb,SAAAA,EAAA,IAAC,QAAA,CACC,KAAK,OACL,KAAK,WACL,GAAG,WACH,MAAOjB,EAAK,SACZ,SAAUM,EACV,SAAQ,GACR,UAAU,iPAAA,CAAA,CAEd,CAAA,CAAA,EACF,SAEC,MACC,CAAA,SAAA,CAACW,EAAAA,IAAA,MAAA,CAAI,UAAU,oCACb,SAAAA,EAAA,IAAC,QAAA,CACC,QAAQ,WACR,UAAU,4CACX,SAAA,QAAA,CAAA,EAGH,EACAA,EAAAA,IAAC,MAAI,CAAA,UAAU,OACb,SAAAA,EAAA,IAAC,QAAA,CACC,KAAK,WACL,KAAK,WACL,GAAG,WACH,MAAOjB,EAAK,SACZ,SAAUM,EACV,SAAQ,GACR,UAAU,+OAAA,CAAA,CAEd,CAAA,CAAA,EACF,EAECT,GACCoB,EAAA,IAAC,MAAI,CAAA,UAAU,mCAAoC,SAAMpB,EAAA,QAG1D,MACC,CAAA,SAAAoB,EAAA,IAAC,SAAA,CACC,KAAK,SACL,UAAU,iJACX,SAAA,OAAA,CAAA,CAGH,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAEJ"}
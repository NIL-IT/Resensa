var L=Object.defineProperty,M=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var R=(r,i,n)=>i in r?L(r,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[i]=n,C=(r,i)=>{for(var n in i||(i={}))V.call(i,n)&&R(r,n,i[n]);if(B)for(var n of B(i))W.call(i,n)&&R(r,n,i[n]);return r},F=(r,i)=>M(r,Q(i));var j=(r,i,n)=>new Promise((p,m)=>{var y=g=>{try{h(n.next(g))}catch(d){m(d)}},k=g=>{try{h(n.throw(g))}catch(d){m(d)}},h=g=>g.done?p(g.value):Promise.resolve(g.value).then(y,k);h((n=n.apply(r,i)).next())});import{jsx as t,jsxs as s,Fragment as E}from"react/jsx-runtime";import{useState as S,useRef as u}from"react";import{I as c}from"./Input-WT1WDFhC.js";import{useDispatch as X,useSelector as Z}from"react-redux";import{f as A,a as O,u as $,h as f,i as D}from"../entry-server.js";import{I as J}from"./ImageUploader-y2axORDI.js";import{useLocation as P}from"react-router-dom";import N from"jodit-react";import{c as v}from"./data-B0z0wmyU.js";import"react-dom/server";import"react-router-dom/server.mjs";import"react-fast-compare";import"invariant";import"shallowequal";import"clsx";import"tailwind-merge";import"@reduxjs/toolkit";import"axios";import"js-cookie";import"lucide-react";const ve=()=>{const r=X(),{pathname:i}=P(),n=i.split("/").at(-1),p=+n==4,m=+n==3;document.body.style.overflowY="hidden";const{itemId:y,equipment:k,solutions:h,news:g}=Z(({user:l})=>l),d=p?g:m?h:k,e=y?d==null?void 0:d.find(l=>+l.id==+y):null,[a,I]=S(()=>{const l=p?{title:(e==null?void 0:e.title)||"",text:(e==null?void 0:e.text)||"",page_description:(e==null?void 0:e.page_description)||"",page_title:(e==null?void 0:e.page_title)||"",page_keywords:(e==null?void 0:e.page_keywords)||"",hidden_seo_text:(e==null?void 0:e.hidden_seo_text)||""}:m?{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",sub_header:(e==null?void 0:e.sub_header)||"",header:(e==null?void 0:e.header)||"",image_banner_alt:(e==null?void 0:e.image_banner_alt)||"",image_card_alt:(e==null?void 0:e.image_card_alt)||"",page_description:(e==null?void 0:e.page_description)||"",page_title:(e==null?void 0:e.page_title)||"",page_keywords:(e==null?void 0:e.page_keywords)||"",extra_description:(e==null?void 0:e.extra_description)||"",hidden_seo_text:(e==null?void 0:e.hidden_seo_text)||""}:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",min_param:(e==null?void 0:e.min_param)||"",max_param:(e==null?void 0:e.max_param)||"",sub_header:(e==null?void 0:e.sub_header)||"",header:(e==null?void 0:e.header)||"",image_banner_alt:(e==null?void 0:e.image_banner_alt)||"",image_card_alt:(e==null?void 0:e.image_card_alt)||"",page_description:(e==null?void 0:e.page_description)||"",page_title:(e==null?void 0:e.page_title)||"",page_keywords:(e==null?void 0:e.page_keywords)||"",extra_description:(e==null?void 0:e.extra_description)||"",hidden_seo_text:(e==null?void 0:e.hidden_seo_text)||""};return e!=null&&e.image&&(p?l.news_photo=e.image:m?l.solution_photo=e.image:l.equipment_photo=e.image),l}),b=(l,_)=>{I(x=>F(C({},x),{[_]:l}))},[w,K]=S(),[q,T]=S(),o=l=>{const{name:_,value:x}=l.target;I(H=>F(C({},H),{[_]:x}))},U=u(null),Y=u(null),z=u(null),G=u(null);return t("section",{className:"fixed inset-0 flex items-center justify-center",children:s("div",{className:`bg-white  h-[80%] py-[38px] px-8 \r
      rounded-lg w-full max-w-[663px]  overflow-y-scroll overflow-x-hidden  relative`,children:[t("button",{onClick:()=>{r(A(!1)),r(O(null))},className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:"✕"}),t("h2",{className:"text-center text-[32px] font-medium leading-[40.8px] text-gray-400 mb-6",children:p?"Изменить новость":m?"Изменить решения":"Изменить оборудование"}),s("form",{onSubmit:l=>j(void 0,null,function*(){l.preventDefault();try{if(p){const _=w?{title:a.title,text:a.text,news_photo:w,page_description:a.page_description,page_title:a.page_title,page_keywords:a.page_keywords,hidden_seo_text:a.hidden_seo_text}:{title:a.title,text:a.text,page_description:a.page_description,page_title:a.page_title,page_keywords:a.page_keywords,hidden_seo_text:a.hidden_seo_text};yield r(D({id:e==null?void 0:e.id,data:_})).unwrap()}else if(!m){const x={name:a.name,description:a.description,image_card:w,image_banner:q,min_param:parseInt(a.min_param),max_param:parseInt(a.max_param),sub_header:a==null?void 0:a.sub_header,header:a==null?void 0:a.header,image_banner_alt:a==null?void 0:a.image_banner_alt,image_card_alt:a==null?void 0:a.image_card_alt,extra_description:a==null?void 0:a.extra_description,page_description:a==null?void 0:a.page_description,page_title:a==null?void 0:a.page_title,page_keywords:a==null?void 0:a.page_keywords,hidden_seo_text:a==null?void 0:a.hidden_seo_text};yield r($({id:e==null?void 0:e.id,data:x})).unwrap()}else if(m){const x={name:a.name,description:a.description,image_card:w,image_banner:q,sub_header:a==null?void 0:a.sub_header,header:a==null?void 0:a.header,image_banner_alt:a==null?void 0:a.image_banner_alt,image_card_alt:a==null?void 0:a.image_card_alt,page_description:a==null?void 0:a.page_description,page_title:a==null?void 0:a.page_title,page_keywords:a==null?void 0:a.page_keywords,extra_description:a==null?void 0:a.extra_description,hidden_seo_text:a==null?void 0:a.hidden_seo_text};yield r(f({id:e==null?void 0:e.id,data:x})).unwrap()}r(A(!1)),r(O(null))}catch(_){alert(_.message||"Не удалось сохранить изменения. Возможно вы уже добавляли фотографию с таким названием, переименуйте и попробуйте снова.")}}),className:"space-y-[18px]",children:[!p&&s("div",{children:[t("p",{className:"w-full text-sm text-gray-900",children:"Изображение для баннера"}),t(J,{banner:!0,newsBanner:!!p,findProduct:e,onFileSelect:T}),s("div",{className:"space-y-2 mt-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Alt-тег для баннера"}),t(c,{type:"text",name:"image_banner_alt",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.image_banner_alt,onChange:o,placeholder:"Описание изображения баннера"})]})]}),s("div",{children:[t("p",{className:"w-full text-sm text-gray-900",children:"Изображение для карточки"}),t(J,{findProduct:e,onFileSelect:K}),!p&&s("div",{className:"space-y-2 mt-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Alt-тег для карточки"}),t(c,{type:"text",name:"image_card_alt",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.image_card_alt,onChange:o,placeholder:"Описание изображения карточки"})]})]}),p&&s(E,{children:[s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Название"}),t(c,{type:"text",name:"title",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.title,onChange:o})]}),s("div",{className:"space-y-2",children:[t("label",{htmlFor:"text",className:"block text-sm font-medium text-gray-900",children:"Текст новости"}),t(N,{ref:U,value:a.text,config:v,onBlur:l=>b(l,"text")})]})]}),!p&&s(E,{children:[s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Название"}),t(c,{type:"text",name:"name",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.name,onChange:o})]}),s("div",{className:"space-y-2",children:[t("label",{htmlFor:"message",className:"block text-sm text-gray-900",children:"Описание"}),t(N,{ref:Y,value:a.description,config:v,onBlur:l=>b(l,"description")}),t("label",{htmlFor:"extra_description",className:"block text-sm text-gray-900 pt-4",children:"Полное описание товара"}),t(N,{ref:z,value:a.extra_description,config:v,onBlur:l=>b(l,"extra_description")})]}),s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900 pt-4",children:"Заголовок баннера"}),t(c,{type:"text",name:"sub_header",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.sub_header,onChange:o})]}),s("div",{className:"space-y-2",children:[t("label",{htmlFor:"message",className:"block text-sm text-gray-900",children:"Текст баннера"}),t(N,{ref:G,value:a.header,config:v,onBlur:l=>b(l,"header")})]})]}),!m&&!p&&s(E,{children:[s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900 pt-4",children:"Минимальный параметр"}),t(c,{type:"text",name:"min_param",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.min_param,onChange:o})]}),s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Максимальный параметр"}),t(c,{type:"text",name:"max_param",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.max_param,onChange:o})]})]}),s("div",{className:"border-t border-gray-200 pt-4 space-y-[18px]",children:[t("h3",{className:"text-lg font-medium text-gray-900",children:"SEO информация"}),s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Заголовок страницы (Title)"}),t(c,{type:"text",name:"page_title",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.page_title,onChange:o,placeholder:"Заголовок для SEO"})]}),s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Описание страницы (Description)"}),t("textarea",{name:"page_description",rows:"3",onChange:o,className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.page_description,placeholder:"Краткое описание для поисковых систем"})]}),s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Текст для поисковых систем"}),t("textarea",{name:"hidden_seo_text",rows:"3",onChange:o,className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.hidden_seo_text,placeholder:"Этот текст предназначен для поисковых систем и не виден пользователям. "})]}),s("div",{className:"space-y-2",children:[t("p",{className:"w-full text-sm text-gray-900",children:"Ключевые слова (Keywords)"}),t(c,{type:"text",name:"page_keywords",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:a.page_keywords,onChange:o,placeholder:"Ключевые слова через запятую"})]})]}),t("button",{type:"submit",className:"w-full p-3 bg-gray-400 text-white rounded hover:bg-[#2F2F2F] transition-colors text-lg font-medium",children:"ИЗМЕНИТЬ"})]})]})})};export{ve as default};

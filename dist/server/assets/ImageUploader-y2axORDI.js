import{jsxs as r,jsx as a,Fragment as y}from"react/jsx-runtime";import{useState as d,useRef as G}from"react";import{useSelector as E}from"react-redux";import{useLocation as O}from"react-router-dom";const q=({onFileSelect:s,findProduct:m,banner:p=!1})=>{const[N,u]=d(!1),[f,l]=d(""),o=G(null),{itemId:D,addNewItemPopup:w,news:j,solutions:P,equipment:U}=E(({user:e})=>e),{pathname:k}=O(),h=k.split("/").at(-1);let t=m,i=+h==4,C=+h==3;if(!m){const e=i?j:C?P:U;t=e==null?void 0:e.find(g=>+g.id==+D)}const[n,x]=d(i?t==null?void 0:t.image:p?t==null?void 0:t.image_banner:(t==null?void 0:t.image_card)||null),c=e=>{e.preventDefault(),e.stopPropagation(),u(e.type==="dragenter"||e.type==="dragover")},v=e=>{if(["image/svg+xml","image/png","image/jpeg"].includes(e.type)){const g=URL.createObjectURL(e);x(g),s&&s(e),l("")}else l("Пожалуйста, загрузите PNG, или JPEG файл.")},I=e=>{e.preventDefault(),e.stopPropagation(),u(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&v(e.dataTransfer.files[0])},R=e=>{e.preventDefault(),e.target.files&&e.target.files[0]&&v(e.target.files[0])},L=()=>{var e;(e=o.current)==null||e.click()},b=()=>{n&&URL.revokeObjectURL(n),x(null),l(""),s&&s(null),o.current&&(o.current.value="")};return r("div",{className:"w-full mx-auto",children:[n&&!w&&t?r("div",{className:"relative p-8 mt-2 border-2 border-dashed rounded-lg text-center",children:[a("img",{src:n,alt:"Текущее изображение",className:"max-h-[200px] mx-auto rounded-lg"}),a("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),b()},className:"absolute top-2 right-2 w-6 h-6 flex items-center justify-center bg-gray-800 text-white rounded-full hover:bg-gray-900",children:"×"})]}):r("div",{className:`relative p-8 mt-2 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors
            ${N?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:c,onDragLeave:c,onDragOver:c,onDrop:I,onClick:L,children:[a("input",{ref:o,type:"file",accept:".svg,.png,.jpg,.jpeg",onChange:R,className:"hidden"}),n?r(y,{children:[a("img",{src:n,alt:"Предпросмотр",className:"max-h-[200px] mx-auto rounded-lg"}),a("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),b()},className:"absolute top-2 right-2 w-6 h-6 flex items-center justify-center bg-gray-800 text-white rounded-full hover:bg-gray-900",children:"×"})]}):r(y,{children:[r("p",{className:"mb-2 text-sm text-gray-500",children:[a("span",{className:"font-semibold",children:"Нажмите, чтобы загрузить"})," ","или перетащите"]}),r("p",{className:"text-xs text-gray-500",children:["PNG, JPG"," ",i?"(Рекомендуемое разрешение 847 x 300 px)":p?"(Рекомендуемое разрешение 1920 x 900 px)":"(Рекомендуемое разрешение 320 x 320 px)"]})]})]}),f&&a("p",{className:"mt-2 text-red-500 text-sm",children:f})]})};export{q as I};

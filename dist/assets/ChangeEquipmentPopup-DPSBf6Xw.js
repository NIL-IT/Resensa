var U=Object.defineProperty,Y=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var v=(t,r,l)=>r in t?U(t,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[r]=l,F=(t,r)=>{for(var l in r||(r={}))A.call(r,l)&&v(t,l,r[l]);if(_)for(var l of _(r))G.call(r,l)&&v(t,l,r[l]);return t},k=(t,r)=>Y(t,z(r));var S=(t,r,l)=>new Promise((m,i)=>{var b=o=>{try{g(l.next(o))}catch(c){i(c)}},y=o=>{try{g(l.throw(o))}catch(c){i(c)}},g=o=>o.done?m(o.value):Promise.resolve(o.value).then(b,y);g((l=l.apply(t,r)).next())});import{r as j,j as a}from"./three-vendor-D76XtHXd.js";import{I as h}from"./Input-B2dwBdFY.js";import{u as H,h as J,a as K,i as C,b as I,j as L,k as M,l as O}from"./index-BJ7rdYQL.js";import{I as f}from"./ImageUploader-C2oytvzG.js";import"./react-vendor-C6O4aKhz.js";const $=()=>{const t=H(),{pathname:r}=J(),l=r.split("/").at(-1),m=+l==4,i=+l==3;document.body.style.overflowY="hidden";const{itemId:b,equipment:y,solutions:g,news:o}=K(({user:n})=>n),c=m?o:i?g:y,e=b?c==null?void 0:c.find(n=>+n.id==+b):null;console.log(e);const[s,w]=j.useState(()=>{const n=m?{title:(e==null?void 0:e.title)||"",text:(e==null?void 0:e.text)||""}:i?{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",sub_header:(e==null?void 0:e.sub_header)||"",header:(e==null?void 0:e.header)||""}:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",min_param:(e==null?void 0:e.min_param)||"",max_param:(e==null?void 0:e.max_param)||"",sub_header:(e==null?void 0:e.sub_header)||"",header:(e==null?void 0:e.header)||""};return e!=null&&e.image&&(m?n.news_photo=e.image:i?n.solution_photo=e.image:n.equipment_photo=e.image),n}),[u,q]=j.useState(),[N,E]=j.useState(),x=n=>{const{name:p,value:d}=n.target;w(R=>k(F({},R),{[p]:d}))},B=n=>S(void 0,null,function*(){n.preventDefault();try{if(m){const p=u?{title:s.title,text:s.text,news_photo:u}:{title:s.title,text:s.text};yield t(O({id:e==null?void 0:e.id,data:p})).unwrap(),w({title:(s==null?void 0:s.title)||"",text:(s==null?void 0:s.text)||""})}else if(!i){const d={name:s.name,description:s.description,image_card:u,image_banner:N,min_param:parseInt(s.min_param),max_param:parseInt(s.max_param),sub_header:s==null?void 0:s.sub_header,header:s==null?void 0:s.header};yield t(L({id:e==null?void 0:e.id,data:d})).unwrap()}else if(i){const d={name:s.name,description:s.description,image_card:u,image_banner:N,sub_header:s==null?void 0:s.sub_header,header:s==null?void 0:s.header};yield t(M({id:e==null?void 0:e.id,data:d})).unwrap()}t(C(!1)),t(I(null))}catch(p){alert(p.message||"Не удалось сохранить изменения. Возможно вы уже добавляли фотографию с таким названием, переименуйте и попробуйте снова.")}});return a.jsx("section",{className:"fixed inset-0 flex items-center justify-center",children:a.jsxs("div",{className:`bg-white  h-[80%] py-[38px] px-8 \r
      rounded-lg w-full max-w-[663px]  overflow-scroll  relative`,children:[a.jsx("button",{onClick:()=>{t(C(!1)),t(I(null))},className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:"✕"}),a.jsx("h2",{className:"text-center text-[32px] font-medium leading-[40.8px] text-gray-400 mb-6",children:m?"Изменить новость":i?"Изменить решения":"Изменить оборудование"}),a.jsxs("form",{onSubmit:B,className:"space-y-[18px]",children:[!m&&a.jsxs("div",{children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Изображение для баннера"}),a.jsx(f,{banner:!0,newsBanner:!!m,findProduct:e,onFileSelect:E})]}),a.jsxs("div",{children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Изображение для карточки"}),a.jsx(f,{findProduct:e,onFileSelect:q})]}),m?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Название"}),a.jsx(h,{type:"text",name:"title",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.title,onChange:x})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-900",children:"Текст новости"}),a.jsx("textarea",{id:"message",name:"text",rows:"4",onChange:x,className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.text})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Название"}),a.jsx(h,{type:"text",name:"name",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.name,onChange:x})]}),!m&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"message",className:"block text-sm text-gray-900",children:"Описание"}),a.jsx("textarea",{id:"message",name:"description",rows:"4",onChange:x,className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.description})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Заголовок баннера"}),a.jsx(h,{type:"text",name:"sub_header",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.sub_header,onChange:x})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"message",className:"block text-sm text-gray-900",children:"Текст баннера"}),a.jsx("textarea",{id:"message",name:"header",rows:"4",onChange:x,className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.header})]})]}),!i&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Минимальный параметр"}),a.jsx(h,{type:"text",name:"min_param",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.min_param,onChange:x})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"w-full text-sm text-gray-900",children:"Максимальный параметр"}),a.jsx(h,{type:"text",name:"max_param",className:"block p-2.5 w-full text-base text-gray-400 font-normal bg-gray-50 rounded-lg border border-gray-300",value:s.max_param,onChange:x})]})]})]}),a.jsx("button",{type:"submit",className:"w-full p-3 bg-gray-400 text-white rounded hover:bg-[#2F2F2F] transition-colors text-lg font-medium",children:"ИЗМЕНИТЬ"})]})]})})};export{$ as default};
